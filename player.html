<!DOCTYPE html>
<html>
<head>
    <title>Stony 250</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        /* Скрываем элементы управления */
        audio {
            display: none;
        }
    </style>
</head>
<body>

<audio id="audio" preload="auto" webkit-playsinline playsinline loop></audio>

<script>
    (function() {
        // 1. Инициализация аудио
        const audio = document.getElementById('audio');
        audio.volume = 1.0; // Максимальная громкость
        audio.src = 'https://www.myinstants.com/media/sounds/stony-250.mp3';

        // 2. Блокировка изменения громкости
        function enforceMaxVolume() {
            audio.volume = 1.0; // Принудительно устанавливаем максимальную громкость
        }

        // 3. Комбинированная стратегия воспроизведения
        function playAudio() {
            // Попытка Web Audio API (лучше для автовоспроизведения)
            if (window.AudioContext || window.webkitAudioContext) {
                const ctx = new (AudioContext || webkitAudioContext)();
                const source = ctx.createBufferSource();

                fetch(audio.src)
                    .then(r => r.arrayBuffer())
                    .then(buf => ctx.decodeAudioData(buf))
                    .then(buffer => {
                        source.buffer = buffer;
                        source.connect(ctx.destination);
                        source.start(0);
                        if (ctx.state === 'suspended') ctx.resume();
                    })
                    .catch(() => fallbackPlay());
            } else {
                fallbackPlay();
            }
        }

        // 4. Fallback для старых браузеров
        function fallbackPlay() {
            audio.play()
                .catch(e => {
                    // Обход для iOS: симуляция жестов
                    const events = ['click', 'touchstart', 'mousedown'];
                    events.forEach(e => {
                        window.dispatchEvent(new Event(e));
                        window.addEventListener(e, () => {}, {once: true});
                    });

                    // Финальная попытка после симуляции
                    setTimeout(() => audio.play().catch(() => {}), 300);
                });
        }

        // 5. Запуск при загрузке
        document.addEventListener('DOMContentLoaded', () => {
            playAudio();

            // Дополнительные обработчики для iOS
            document.addEventListener('gesturestart', playAudio);
            document.addEventListener('touchstart', playAudio, {once: true});

            // Принудительное восстановление громкости
            setInterval(enforceMaxVolume, 100); // Каждые 100 мс проверяем громкость
        });

        // 6. Предотвращение остановки
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && audio.paused) playAudio();
        });

        // 7. Отключение возможности паузы
        audio.onpause = () => {
            audio.play(); // Если аудио было поставлено на паузу, сразу возобновляем воспроизведение
        };

        // 8. Циклическое воспроизведение
        audio.loop = true; // Включаем бесконечный цикл
    })();
</script>

</body>
</html>